apiVersion: projectcontour.io/v1
kind: HTTPProxy
metadata:
  name: firefly--firefly-api-dev-base-route
  namespace: ns-team-firefly--firefly-api-deploy--ffd95da3--namesp-ed34d692
spec:
  routes:
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: spl_path
        disabled: false
      conditions:
        - prefix: /spl
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: FireFlyGuidedTemplateGen
        disabled: false
      conditions:
        - prefix: /v1/templates/guided-generations
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: FireFlyTemplateGen
        disabled: false
      conditions:
        - prefix: /v1/templates/generations
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: PingCheck
        disabled: false
      conditions:
        - prefix: /ping
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: CreditsBalance
        disabled: false
      conditions:
        - prefix: /v1/credits/balance
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: FireflyPipelineVersion
        disabled: false
      conditions:
        - prefix: /v1/pipeline/versions
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: FireflyGuidedImageGen
        disabled: false
      conditions:
        - prefix: /v1/images/guided-generations
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: FireflyImageGen
        disabled: false
      conditions:
        - prefix: /v1/images/generations
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: FireflyImagePublish
        disabled: false
      conditions:
        - prefix: /v1/images/published
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: v2_images_generate
        disabled: false
      conditions:
        - prefix: /v2/images/generate
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: v2_images_generate_similar
        disabled: false
      conditions:
        - prefix: /v2/images/generate-similar
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: Promptsuggestions
        disabled: false
      conditions:
        - prefix: /v1/prompt/suggestions
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: UserAccess
        disabled: false
      conditions:
        - prefix: /v1/users/access
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: ImageUpload
        disabled: false
      conditions:
        - prefix: /v2/storage/image
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: v1_images_fill
        disabled: false
      conditions:
        - prefix: /v1/images/fill
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s
    - 'adobe:perFilterConfig':
        envoy.filters.http.header_size:
          header_size:
            max_bytes: 12288
      authPolicy:
        context:
          policyId: v1_images_expand
        disabled: false
      conditions:
        - prefix: /v1/images/expand
      enableWebsockets: false
      healthCheckPolicy:
        healthyThresholdCount: 1
        intervalSeconds: 3
        path: /ping
        timeoutSeconds: 5
        unhealthyThresholdCount: 3
      permitInsecure: false
      rateLimitPolicy:
        global:
          descriptors:
            - entries:
                - requestHeaderValueMatch:
                    headers:
                      - contains: techacct
                        name: x-gw-ims-user-id
                    value: third
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
            - entries:
                - requestHeader:
                    descriptorKey: ims_user_id
                    headerName: x-gw-ims-user-id
      services:
        - name: o0b1283ddfb99
          port: 8080
          weight: 100
      timeoutPolicy:
        'adobe:connect': 0s250ms
        idle: 5m0s
        idleConnection: 0m58s
        response: 1m0s